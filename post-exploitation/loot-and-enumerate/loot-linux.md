# Loot Linux

## Passwords and Hashes

* First grab the passwd and shadow file

```bash
cat /etc/passwd
cat /etc/shadow
```

* crack the password using john the ripper

```bash
unshadow passwd shadow > unshadowed.txt
john --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt
```

## Mail

```bash
/var/mail
/var/spool/mail
```

## Tcp-Dump

* figure out what interfaces the machine is using: ifconfig
* then start to capture packets

### Fast Command

```bash
tcpdump -i any -s0 -w capture.pcap
tcpdump -i eth0 -w capture -n -U -s 0 src not 192.168.1.X and dst not 192.168.1.X
tcpdump -vv -i eth0 src not 192.168.1.X and dst not 192.168.1.X
```

### Useful Flags

* let's start with the basics. "tcpdump" - this command will output all network traffic straight to the terminal. Might be hard to understand if there is a lot of traffic
* \-A (stands for Ascii, and output it in ascii)
* \-w file.pcap the (saves the output into the filename of your choice, the traffic is stored in pcap-format, which is the standard packet-analysis-format)
* \-i any (will capture traffic for all interfaces)
* \-D (show list of all interfaces)
* \-q (be less verbose/more quiet)
* \-s (the default size that tcpdump captures is only 96 bytes, to capture more you have to define it yourself, -s0 gives you the whole packet
* \-c (sets how many packets you want to intercept, then stops, useful if you have a non-interactive shell)
* port 22 (only see traffic on a specific port)
* \-vvv (verbose)

### Useful Commands

* lots of good stuff here [http://www.rationallyparanoid.com/articles/tcpdump.html](http://www.rationallyparanoid.com/articles/tcpdump.html)
* grep all GET from the wlan0 interface, this will not get any SSL-encrypted traffic

```bash
tcpdump -i wlan0 -vvv -A | grep "GET"
```

* print the traffic in hex with ascii interpretation

```bash
tcpdump -nX -r file.pcap
```

* only record tcp-traffic

```bash
tcpdump tcp -w file.pcap
```

### Sniffing for Passwords

* insert dumped traffic into metasploit and run psnuffle on it
* it will sniff passwords and usernames from pop3, imap, ftp, and HTTP GET
* easy way to find usernames and passwords from dumped traffic

```bash
use auxiliary/sniffer/psnuffle
```

* [https://www.offensive-security.com/metasploit-unleashed/password-sniffing/](https://www.offensive-security.com/metasploit-unleashed/password-sniffing/)

## References

* [http://www.thegeekstuff.com/2010/08/tcpdump-command-examples/](http://www.thegeekstuff.com/2010/08/tcpdump-command-examples/)
* [https://danielmiessler.com/study/tcpdump/](https://danielmiessler.com/study/tcpdump/)
* [https://www.sans.org/reading-room/whitepapers/testing/post-exploitation-metasploit-pivot-port-33909](https://www.sans.org/reading-room/whitepapers/testing/post-exploitation-metasploit-pivot-port-33909)
* [http://jvns.ca/blog/2016/03/16/tcpdump-is-amazing/](http://jvns.ca/blog/2016/03/16/tcpdump-is-amazing/)
