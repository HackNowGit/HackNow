# Upgrade Non tty Shell

## Overview

* ff you have a non-tty-shell there are certain commands and stuff you can't do
* this can happen if you upload reverse shells on a webserver, so that the shell you get is by the user www-data, or similar
* these users are not meant to have shells as they don't interact with the system has humans do
* anyways, if you get one of these shells you can upgrade it to a tty-shell using the following methods

## XTerm Method

Now, we want to make our shell more fully featured and resilient. The first step to this is to run python3 -c ‘import pty;pty.spawn(“/bin/bash”)’ in order to start a bash session. Then we want to run export TERM=xterm to give us access to term commands. Then finally use ctrl + Z in order to background the shell and then run stty raw -echo; fg

```bash
# run this first
python3 -c 'import pty;pty.spawn("/bin/bash")' # starts a bash session
python -c 'import pty;pty.spawn("/bin/bash")' # use this if Python3 does not work
# run this second
export TERM=xterm # gives us access to term commandss
# run this third
CTRL + Z # backgrounds the shell 
# run this fourth
stty raw -echo; fg # brings the shell back to the foreground
```

## Using Python

```bash
python -c 'import pty; pty.spawn("/bin/bash")' THIS MAY ALSO WORK
python -c 'import pty; pty.spawn("/bin/bash");'  ALSO TRY LIKE THIS
```

## Echo

```bash
echo 'os.system('/bin/bash')'
```

## sh

```bash
/bin/sh -i
```

## Bash

```bash
/bin/bash -i
```

## Perl

```bash
perl -e 'exec "/bin/sh";'
```

## From within VI

```bash
:!bash
```

## Interactive tty-shell

* if you manage to upgrade to a non-interactive tty-shell you will still have a limited shell
* you won't be able to use the up and down arrows, you won't have tab-completion
* this might be really frustrating if you stay in that shell for long
* it can also be more risky, if a execution gets stuck you cant use Ctr-C or Ctr-Z without killing your session
* however that can be fixed using socat, follow these instructions
* [https://github.com/cornerpirate/socat-shell](https://github.com/cornerpirate/socat-shell)

## Use this and Go Down the List using them all

* [https://netsec.ws/?p=337](https://netsec.ws/?p=337)

```bash
python -c 'import pty; pty.spawn("/bin/bash")'
```

## References

* [https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys](https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys)
* [http://unix.stackexchange.com/questions/122616/why-do-i-need-a-tty-to-run-sudo-if-i-can-sudo-without-a-password](http://unix.stackexchange.com/questions/122616/why-do-i-need-a-tty-to-run-sudo-if-i-can-sudo-without-a-password)
* [http://netsec.ws/?p=337](http://netsec.ws/?p=337)
* [http://pentestmonkey.net/blog/post-exploitation-without-a-tty](http://pentestmonkey.net/blog/post-exploitation-without-a-tty)
* [https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/](https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/)
* [https://null-byte.wonderhowto.com/how-to/upgrade-dumb-shell-fully-interactive-shell-for-more-flexibility-0197224/](https://null-byte.wonderhowto.com/how-to/upgrade-dumb-shell-fully-interactive-shell-for-more-flexibility-0197224/)
* [https://hackofalltrades.dev/advent-of-cyber-day-24-the-trial-before-christmas/](https://hackofalltrades.dev/advent-of-cyber-day-24-the-trial-before-christmas/) (the end of this walkthrough explains how he upgraded his shell and it really stuck with me)
