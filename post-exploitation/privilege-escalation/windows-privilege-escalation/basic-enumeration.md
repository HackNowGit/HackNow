# Basic Enumeration

## Overview

* before we start looking for privilege escalation opportunities we need to understand a bit about the machine
* we need to know what users have privileges and what patches/hotfixes the system has.

## Basics

```bash
systeminfo
hostname

#Any strange or hidden directories/files in C drive?
cmd.exe /c dir /a C:/

#Shows all files in C:\users and sub-directories.
gci -Recurse C:\users | Select FullName

# What non-default software is installed?
ls "C:\Program Files" 
dir "C:\Program Files"

# What non-default software is installed? 
ls "C:\Program Files (x86)"
dir "C:\Program Files (x86)"
```

## Who am I?

```bash
whoami
whoami /priv
echo %username%
```

## What Users/Local Groups are on the Machine?

```bash
net users
net localgroups
```

## More Info About a Specific User, Check if User has Privileges

```bash
net user user1

# check the directory privileges of groups
icacls "C:\Folder"
```

## View Domain Groups

```bash
net group /domain

# view current domain
systeminfo | findstr /B "Domain"
```

## View Members of Domain Group

```bash
net group /domain <Group Name>
```

## Firewall

```bash
netsh firewall show state
netsh firewall show config
```

## Network

```bash
ipconfig /all
route print
arp -A
```

## How Well Patched is the System?

```bash
wmic qfe get Caption,Description,HotFixID,InstalledOn
```

## Search for Cleartext Passwords

```bash
findstr /si password *.txt
findstr /si password *.xml
findstr /si password *.ini
#Find all those strings in config files.
dir /s *pass* == *cred* == *vnc* == *.config*
#Find all Passwords in all Files
findstr /spin "password" *.*

findstr /spin "password" *.*
```

## In Files

* these are common files to find them in
* they might be base64-encoded, so look out for that

```bash
c:\sysprep.inf
c:\sysprep\sysprep.xml
c:\unattend.xml
%WINDIR%\Panther\Unattend\Unattended.xml
%WINDIR%\Panther\Unattended.xml
dir c:\*vnc.ini /s /b
dir c:\*ultravnc.ini /s /b
dir c:\ /s /b | findstr /si *vnc.ini
```

## In Registry

### VNC

```bash
reg query "HKCU\Software\ORL\WinVNC3\Password"
```

### Windows Auto Login

```bash
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"
```

### SNMP Paramters

```bash
reg query "HKLM\SYSTEM\Current\ControlSet\Services\SNMP"
```

### Putty

```bash
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions"
```

### Search for Passwords in Registry

```bash
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s
```
