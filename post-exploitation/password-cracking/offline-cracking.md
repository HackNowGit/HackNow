# Offline Cracking

## Overview

* passwords or other credentials in databases are often hashed
* first identify which hash is used and then try to crack it

## Identify hash

* there are generally speaking three pieces of data we can use to identify a hash
* the length of the hash
* the character set
* any special characters
* use specialized tools that analyze the hash and then return a guess on which algorithm it is
* an easier way is of course to just look in the documentation of the software where you found the hashes
* in kali we can use hash-identifier or hashid

```bash
hash-identifier
hashid
```

* or these online services
* [http://www.onlinehashcrack.com/hash-identification.php](http://www.onlinehashcrack.com/hash-identification.php)
* [https://md5hashing.net/hash\_type\_checker](https://md5hashing.net/hash\_type\_checker)

## Cracking the Hash

### Hashcat

* look for the specific type of hash you want to crack in the list produced by the following command

```bash
hashcat --help
```

* example: a hash was an Apache md5, so use the corresponding code for it, 1600

```bash
-m 1600
```

* attack mode and 0 is for “straight”

```bash
-a 0
```

* cracked hash output

```bash
-o found.txt
```

* the hash you want to crack

```bash
admin.hash
```

* full command

```bash
hashcat -m 11 -a 0 -o found.txt admin.hash /usr/share/hashcat/rules/rockyou-30000.rule
```

### John the ripper

```bash
john --wordlist=wordlist.txt dump.txt
```

* if you do not find the password you can add the john-rules. Which add numbers and such things to each password.

```bash
john --rules --wordlist=wordlist.txt dump.txt
```

## Linux Shadow Password

* combine the passwd file with the shadow file using the unshadow-program

```bash
unshadow passwd-file.txt shadow-file.txt > unshadowed.txt
```

```bash
john --rules --wordlist=wordlist.txt unshadowed.txt
```

## Using Online Tools to Find Hashes

* findmyhash

```bash
findmyhash LM -h 6c3d4c343f999422aad3b435b51404ee:bcd477bfdb45435a34c6a38403ca4364
```

## Using Online Tools to Crack Hashes

* crackstation [https://crackstation.net/](https://crackstation.net/)
* hashkiller [https://hashkiller.co.uk/](https://hashkiller.co.uk/)
* google hashes by searching pastebin

## Windows

* local file inclusion vulnerability allows retrieval of two fundamental files from Windows
* the system registry and the SAM registry
* these two files/registries are needed to get the machines hashes
* SAM file can be found here

```bash
%SYSTEMROOT%\repair\SAM
```

```bash
windows\repair\SAM
```

```bash
%SYSTEMROOT%\System32\config\RegBack\SAM
```

* system file can be found here

```bash
SYSTEMROOT%\repair\system
```

```bash
%SYSTEMROOT%\System32\config\RegBack\system
```

* extract the password hashes like this (many other methods)

```bash
pwdump system sam
```
